import{T as b,b as g,g as n}from"./index-fe06ba43.js";import{C as h,l as v}from"./constants-df4c2998.js";import{a as w,j as y,x as i,h as $,m as c,n as o,t as a,e as S}from"./vendor-38c8194b.js";var f=Object.defineProperty,x=Object.getOwnPropertyDescriptor,r=(t,e,l,u)=>{for(var d=u>1?void 0:u?x(e,l):e,p=t.length-1,m;p>=0;p--)(m=t[p])&&(d=(u?m(e,l,d):m(d))||d);return u&&d&&f(e,l,d),d};let s=class extends b({}){constructor(){super(...arguments),this.bindBridge=new w(this,g),this.twitter="",this.shareHolder="",this.buying=!1,this.selling=!1,this.supply=0,this.updateSupply=n("Fans3Shares",{address:h}).then(t=>t.sharesSupply(this.shareHolder).then(e=>(this.supply=e,e)).catch(()=>0)),this.price=n("Fans3Shares",{address:h}).then(t=>t.getBuyPrice(this.shareHolder,1).then(e=>y(e))),this.buyPrice=n("Fans3Shares",{address:h}).then(t=>t.getBuyPrice(this.shareHolder,1).then(e=>y(e))),this.sellPrice=n("Fans3Shares",{address:h}).then(t=>t.getSellPrice(this.shareHolder,1).then(e=>y(e))),this.holders=n("Fans3Shares",{address:h}).then(t=>t.getFansOfSubject(this.shareHolder).then(e=>i`<ul>${$(e,l=>i`<li>${l}: ${c(this.holding(l))}</li>`)}</ul>`))}get account(){return g.account}holding(t){return n("Fans3Shares",{address:h}).then(e=>e.sharesBalance(this.shareHolder,t).then(l=>l).catch(()=>0))}link(){}async buy(){this.buying=!0;try{let t=await n("Fans3Shares",{address:h}),e=await t.getBuyPriceAfterFee(this.shareHolder,1);await(await t.buyShares(this.shareHolder,1,{value:e})).wait()}catch(t){this.err=t}this.buying=!1}async sell(){this.selling=!0;try{await(await(await n("Fans3Shares",{address:h})).sellShares(this.shareHolder,1)).wait()}catch(t){this.err=t}this.selling=!1}render(){return i`<div class="home"><div class="ui-container my-4"><img class="w-24 object-contain select-none pointer-events-none" src="${v}"></div><div class="ui-container">${o(this.err,()=>i`<span class="text-red-500">${this.err}</span>`)}<div class="my-4">Wallet Address:<connect-wallet-btn></connect-wallet-btn></div><div class="my-4 ${o(!this.twitter,()=>"hidden")}">Twitter: ${this.twitter}</div><div class="my-4"><span>You are viewing ${this.shareHolder}'s shares</span><br><span>Holding: ${c(this.updateSupply,i`<i class="text-sm mdi mdi-loading"></i>`)}</span><br><span>Price: ${c(this.price,i`<i class="text-sm mdi mdi-loading"></i>`)}</span></div><div class="my-4 ${o(this.account,()=>"hidden")}">Connect your wallet to buy/sell shares</div><div class="my-4 ${o(this.twitter,()=>"hidden")}">Link your twitter to buy/sell shares<ui-button href="http://147.139.3.9:8000/login" class="ml-2" sm>Link</ui-button></div><div class="my-4">Buy price: ${c(this.buyPrice,i`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}<ui-button sm class="m-2" ?disabled="${this.buying}" @click="${this.buy}">Buy${o(this.buying,()=>i`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}</ui-button><br>Sell price: ${c(this.sellPrice,i`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}<ui-button sm class="m-2" ?disabled="${this.selling}" @click="${this.sell}">Sell${o(this.selling,()=>i`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}</ui-button></div><div class="my-4"><span class="my-2">Holdings: of ${this.shareHolder}</span><br>${o(this.supply,()=>i`${c(this.holders,i`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}`)}</div></div></div>`}};r([a()],s.prototype,"twitter",2);r([a()],s.prototype,"shareHolder",2);r([a()],s.prototype,"buying",2);r([a()],s.prototype,"selling",2);r([a()],s.prototype,"err",2);r([a()],s.prototype,"supply",2);r([a()],s.prototype,"updateSupply",2);r([a()],s.prototype,"price",2);r([a()],s.prototype,"buyPrice",2);r([a()],s.prototype,"sellPrice",2);r([a()],s.prototype,"holders",2);s=r([S("view-ex")],s);export{s as ViewEx};
