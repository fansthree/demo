import{T as g,b as n,g as h,e as y}from"./index-7b798231.js";import{l as v}from"./logo-6a7c1939.js";import{s as b,a as f,b as $}from"./utils-324e0987.js";import{a as w,x as t,h as S,m,n as o,k as x,t as c,e as C}from"./vendor-8d27a852.js";var H=Object.defineProperty,P=Object.getOwnPropertyDescriptor,l=(e,s,a,u)=>{for(var i=u>1?void 0:u?P(s,a):s,d=e.length-1,p;d>=0;d--)(p=e[d])&&(i=(u?p(s,a,i):p(i))||i);return u&&i&&H(s,a,i),i};let r=class extends g({}){constructor(){super(...arguments),this.bindBridge=new w(this,n),this.creating=!1,this.holders=h("Fans3Shares").then(e=>e.getFansOfSubject(this.account).then(s=>t`<ul>${S(s,a=>t`<li>${a}: ${m(b(this.account,a),t`<i class="text-sm mdi mdi-loading"></i>`)}</li>`)}</ul>`))}get account(){return n.account}get tgInfo(){return new URL(location.href).searchParams.get("tg")}async reloadSupply(){console.debug("got account",n.account),n.account&&(console.debug("load supply"),this.numSupply=await f(n.account),this.numHolders=await $(n.account),this.requestUpdate())}connectedCallback(){super.connectedCallback(),this.account?this.reloadSupply():y.on("wallet-changed",this.reloadSupply.bind(this))}async create(){this.creating=!0;try{let e=await h("Fans3Shares"),s=await e.getBuyPriceAfterFee(this.account,1);await(await e.buyShares(this.account,1,{value:s})).wait(),this.reloadSupply()}catch(e){this.err=e}this.creating=!1}render(){return t`<div class="home"><div class="ui-container my-4"><img class="w-24 object-contain select-none pointer-events-none" src="${v}"></div><div class="ui-container">${o(this.err,()=>t`<span class="text-red-500">${this.err}</span>`)}<div class="my-4"><span>TG Group: ${this.tgInfo}</span></div><div class="my-4">Wallet Address:<connect-wallet-btn></connect-wallet-btn></div>${o(this.account,()=>t`<ui-link link href="/tg/buy/${this.account}" class="my-2">Link to buy my share</ui-link><div class="my-4"><p class="my-2">shares:${o(this.numSupply!=null,()=>t`${this.numSupply}`,()=>t`<i class="ml-2 text-sm mdi mdi-loading"></i>`)} holders:${o(this.numHolders!=null,()=>this.numHolders,()=>t`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}</p>${x(this.numSupply,[[void 0,()=>t`<i class="ml-2 text-sm mdi mdi-loading"></i>`],[0,()=>t`<ui-button sm class="my-2" ?disabled="${this.creating}" @click="${this.create}">Create${o(this.creating,()=>t`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}</ui-button>`]],()=>t`<p>Holders:</p>${m(this.holders,t`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}`)}</div>`)}</div></div>`}};l([c()],r.prototype,"creating",2);l([c()],r.prototype,"err",2);l([c()],r.prototype,"numSupply",2);l([c()],r.prototype,"numHolders",2);l([c()],r.prototype,"holders",2);r=l([C("tg-create")],r);export{r as TGCreate};
