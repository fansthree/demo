import{T as g,b as m,g as p}from"./index-42126092.js";import{h as y,l as v}from"./utils-8052fc98.js";import{a as f,x as s,h as b,m as d,n as o,t as c,e as $}from"./vendor-aedf1e0d.js";var w=Object.defineProperty,S=Object.getOwnPropertyDescriptor,n=(t,e,i,l)=>{for(var a=l>1?void 0:l?S(e,i):e,h=t.length-1,u;h>=0;h--)(u=t[h])&&(a=(l?u(e,i,a):u(a))||a);return l&&a&&w(e,i,a),a};let r=class extends g({}){constructor(){super(...arguments),this.bindBridge=new f(this,m),this.creating=!1,this.supply=0,this.updateSupply=p("Fans3Shares").then(t=>t.sharesSupply(this.account).then(e=>(this.supply=e,e)).catch(()=>0)),this.holders=p("Fans3Shares").then(t=>t.getFansOfSubject(this.account).then(e=>s`<ul>${b(e,i=>s`<li>${i}: ${d(y(this.account,i),s`<i class="text-sm mdi mdi-loading"></i>`)}</li>`)}</ul>`))}get account(){return m.account}get tgInfo(){return new URL(location.href).searchParams.get("tg")}async create(){this.creating=!0;try{let t=await p("Fans3Shares"),e=await t.getBuyPriceAfterFee(this.account,1);await(await t.buyShares(this.account,1,{value:e})).wait(),this.updateSupply}catch(t){this.err=t}this.creating=!1}render(){return s`<div class="home"><div class="ui-container my-4"><img class="w-24 object-contain select-none pointer-events-none" src="${v}"></div><div class="ui-container">${o(this.err,()=>s`<span class="text-red-500">${this.err}</span>`)}<div class="my-4"><span>TG Group: ${this.tgInfo}</span></div><div class="my-4">Wallet Address:<connect-wallet-btn></connect-wallet-btn></div>${o(this.account,()=>s`<ui-link link href="/x/${this.account}" class="my-2">Link to buy my share</ui-link><div class="my-4"><span class="my-2">${d(this.updateSupply,s`<i class="ml-2 text-sm mdi mdi-loading"></i>`)} holdings</span><br>${o(this.supply,()=>s`${d(this.holders,s`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}`,()=>s`<ui-button sm class="my-2" ?disabled="${this.creating}" @click="${this.create}">Create${o(this.creating,()=>s`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}</ui-button>`)}</div>`)}</div></div>`}};n([c()],r.prototype,"creating",2);n([c()],r.prototype,"err",2);n([c()],r.prototype,"supply",2);n([c()],r.prototype,"updateSupply",2);n([c()],r.prototype,"holders",2);r=n([$("tg-create")],r);export{r as TGCreate};
