import{T as g,b as m,g as h}from"./index-42126092.js";import{h as b,l as v}from"./utils-8052fc98.js";import{a as $,j as y,x as s,h as S,m as o,n as c,t as a,e as w}from"./vendor-aedf1e0d.js";var f=Object.defineProperty,x=Object.getOwnPropertyDescriptor,r=(t,e,l,d)=>{for(var n=d>1?void 0:d?x(e,l):e,u=t.length-1,p;u>=0;u--)(p=t[u])&&(n=(d?p(e,l,n):p(n))||n);return d&&n&&f(e,l,n),n};let i=class extends g({}){constructor(){super(...arguments),this.bindBridge=new $(this,m),this.shareHolder="",this.buying=!1,this.selling=!1,this.supply=0,this.updateSupply=h("Fans3Shares").then(t=>t.sharesSupply(this.shareHolder).then(e=>(this.supply=e,e)).catch(()=>0)),this.price=h("Fans3Shares").then(t=>t.getBuyPrice(this.shareHolder,1).then(e=>y(e))),this.buyPrice=h("Fans3Shares").then(t=>t.getBuyPrice(this.shareHolder,1).then(e=>y(e))),this.sellPrice=h("Fans3Shares").then(t=>t.getSellPrice(this.shareHolder,1).then(e=>y(e))),this.holders=h("Fans3Shares").then(t=>t.getFansOfSubject(this.shareHolder).then(e=>s`<ul>${S(e,l=>s`<li>${l}: ${o(b(this.account,l))}</li>`)}</ul>`))}get account(){return m.account}async buy(){this.buying=!0;try{let t=await h("Fans3Shares"),e=await t.getBuyPriceAfterFee(this.shareHolder,1);await(await t.buyShares(this.shareHolder,1,{value:e})).wait()}catch(t){this.err=t}this.buying=!1}async sell(){this.selling=!0;try{await(await(await h("Fans3Shares")).sellShares(this.shareHolder,1)).wait()}catch(t){this.err=t}this.selling=!1}render(){return s`<div class="home"><div class="ui-container my-4"><img class="w-24 object-contain select-none pointer-events-none" src="${v}"></div><div class="ui-container">${c(this.err,()=>s`<span class="text-red-500">${this.err}</span>`)}<div class="my-4">Wallet Address:<connect-wallet-btn></connect-wallet-btn></div><div class="my-4"><span>You are viewing ${this.shareHolder}'s shares</span><br><span>Holding: ${o(this.updateSupply,s`<i class="text-sm mdi mdi-loading"></i>`)}</span><br><span>Price: ${o(this.price,s`<i class="text-sm mdi mdi-loading"></i>`)}</span></div><div class="my-4 ${c(this.account,()=>"hidden")}">Connect your wallet to buy/sell shares</div><div class="my-4">Buy price: ${o(this.buyPrice,s`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}<ui-button sm class="m-2" ?disabled="${this.buying}" @click="${this.buy}">Buy${c(this.buying,()=>s`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}</ui-button><br>Sell price: ${o(this.sellPrice,s`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}<ui-button sm class="m-2" ?disabled="${this.selling}" @click="${this.sell}">Sell${c(this.selling,()=>s`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}</ui-button></div><div class="my-4"><span class="my-2">Holdings:</span><br>${c(this.supply,()=>s`${o(this.holders,s`<i class="ml-2 text-sm mdi mdi-loading"></i>`)}`)}</div></div></div>`}};r([a()],i.prototype,"shareHolder",2);r([a()],i.prototype,"buying",2);r([a()],i.prototype,"selling",2);r([a()],i.prototype,"err",2);r([a()],i.prototype,"supply",2);r([a()],i.prototype,"updateSupply",2);r([a()],i.prototype,"price",2);r([a()],i.prototype,"buyPrice",2);r([a()],i.prototype,"sellPrice",2);r([a()],i.prototype,"holders",2);i=r([w("tg-buy")],i);export{i as TGBuy};
